# Redis Cache Configuration for AI Calendar Assistant
# This file contains Redis configuration and environment setup

# ============================================================================
# Redis Cache Configuration for Microsoft Graph Operations
# ============================================================================

## Redis Connection Settings
# REDIS_URL=redis://localhost:6379  # For local development
# REDIS_URL=rediss://your-azure-redis.redis.cache.windows.net:6380  # For Azure Redis Cache

# Enable/Disable Redis Caching
REDIS_CACHE_ENABLED=true

# ============================================================================
# Cache TTL (Time To Live) Settings in Seconds
# ============================================================================

# Default TTL for Graph operations (5 minutes)
GRAPH_CACHE_TTL_SECONDS=300

# User information caching (10 minutes - users don't change frequently)
CACHE_TTL_USER_INFO=600

# Department list caching (1 hour - departments rarely change)
CACHE_TTL_DEPARTMENTS=3600

# Conference rooms caching (30 minutes - room details change infrequently)
CACHE_TTL_ROOMS=1800

# Calendar events caching (3 minutes - calendar data is more dynamic)
CACHE_TTL_CALENDAR=180

# Mailbox validation caching (30 minutes - mailbox status is fairly stable)
CACHE_TTL_MAILBOX=1800

# Search results caching (5 minutes - balance between freshness and performance)
CACHE_TTL_SEARCH=300

# ============================================================================
# Redis Security and Performance Settings
# ============================================================================

# Maximum Redis connections in pool
REDIS_MAX_CONNECTIONS=20

# Connection timeout (seconds)
REDIS_CONNECT_TIMEOUT=5

# Socket timeout (seconds)
REDIS_SOCKET_TIMEOUT=5

# Health check interval (seconds)
REDIS_HEALTH_CHECK_INTERVAL=30

# ============================================================================
# Azure Redis Cache Configuration
# ============================================================================

# For Azure deployment, use these settings:
# REDIS_URL=rediss://your-cache-name.redis.cache.windows.net:6380
# REDIS_PASSWORD=your-primary-access-key
# REDIS_SSL=true
# REDIS_SSL_CERT_REQS=required

# For Azure Container Apps with managed identity:
# REDIS_USE_MANAGED_IDENTITY=true
# AZURE_CLIENT_ID=your-managed-identity-client-id

# ============================================================================
# Cache Debug and Monitoring
# ============================================================================

# Enable cache debugging
DEBUG_GRAPH_CACHE=false

# Enable cache hit/miss logging
CACHE_METRICS_ENABLED=true

# Cache statistics logging interval (seconds)
CACHE_STATS_INTERVAL=3600

# ============================================================================
# Environment-Specific Configurations
# ============================================================================

# Development Environment
# REDIS_URL=redis://localhost:6379
# CACHE_TTL_USER_INFO=60        # Shorter TTLs for development
# CACHE_TTL_CALENDAR=30
# DEBUG_GRAPH_CACHE=true

# Staging Environment
# REDIS_URL=rediss://staging-redis.redis.cache.windows.net:6380
# CACHE_TTL_USER_INFO=300       # Medium TTLs for staging
# CACHE_TTL_CALENDAR=120

# Production Environment
# REDIS_URL=rediss://prod-redis.redis.cache.windows.net:6380
# CACHE_TTL_USER_INFO=600       # Longer TTLs for production
# CACHE_TTL_CALENDAR=180
# DEBUG_GRAPH_CACHE=false

# ============================================================================
# Performance Optimization Notes
# ============================================================================

# 1. User Info (600s): Users and their properties don't change frequently
# 2. Departments (3600s): Department lists are very stable
# 3. Conference Rooms (1800s): Room information changes infrequently
# 4. Calendar Events (180s): Needs to be fresh but benefits from short caching
# 5. Mailbox Validation (1800s): Mailbox status is fairly stable
# 6. Search Results (300s): Balance between performance and data freshness

# ============================================================================
# Redis Security Best Practices
# ============================================================================

# 1. Always use TLS (rediss://) for production
# 2. Use Azure Key Vault for Redis credentials
# 3. Enable Redis AUTH
# 4. Configure network security groups
# 5. Use managed identity when possible
# 6. Regularly rotate access keys
# 7. Monitor Redis access logs
# 8. Set appropriate firewall rules

# ============================================================================
# Monitoring and Alerting
# ============================================================================

# Monitor these Redis metrics:
# - Memory usage
# - CPU utilization
# - Connection count
# - Cache hit ratio
# - Network throughput
# - Operation latency

# Set up alerts for:
# - High memory usage (>80%)
# - Low cache hit ratio (<50%)
# - Connection pool exhaustion
# - High latency (>100ms)
# - Connection failures
